[tool.fawltydeps]
# FawltyDeps configuration for MuniMetro API
# This checks API-specific dependencies for deployment

# Code to analyze (API code + shared lib)
code = [".", "../lib"]

# Dependencies file
deps = ["requirements.txt"]

# Ignore dependencies that are used but not imported
ignore_unused = [
    "gunicorn",                  # WSGI server, invoked as CLI tool
    "numpy",                     # Imported lazily inside lib functions
    "pillow",                    # Imported as PIL
    "google-cloud-storage",      # Imported as google
    "google-cloud-secret-manager", # Used at runtime for Cloud Run secrets
    "pytesseract",               # Used by train_detector.py (in scripts/)
    "opencv-python-headless",    # Imported as cv2
    "python-dotenv",             # Imported as dotenv
    "Mastodon.py",               # Imported as mastodon (lazy import in notifiers)
]

# Ignore imports that aren't in requirements.txt (local modules)
ignore_undeclared = [
    "lib",               # Local shared library (../lib/muni_lib.py)
    "PIL",               # Import name for pillow package
    "google",            # Import name for google-cloud-storage package
    "cv2",               # Import name for opencv-python-headless package
    "dotenv",            # Import name for python-dotenv package
    "detect_stations",   # Local module (../scripts/detect_stations.py)
    "station_detector",  # Local module (../scripts/station_detector.py)
    "train_detector",    # Local module (../scripts/train_detector.py)
]

# Custom mapping file for import name to package name mappings
custom_mapping_file = [".fawltydeps_custom_mapping.toml"]
